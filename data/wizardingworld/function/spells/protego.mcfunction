##execute at @s[tag=!use_protego] positioned ~-1.1 ~ ~-1.1 run summon block_display ~ ~ ~ {transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],scale:[2.2f,2.2f,2.2f],translation:[0f,0f,0f]},block_state:{Name:light_blue_stained_glass},Tags:[protego]}
execute if score @s magic_level matches 1 if score @s mana matches 200.. at @s[tag=!use_protego] run summon armor_stand ~ ~ ~ {Tags:[protego],Invisible:1b,NoGravity:1b,Silent:1b,Invulnerable:1b,Passengers:[{id:block_display,Tags:["protego_display"],transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],scale:[2.2f,2.2f,2.2f],translation:[-1.1f,-2f,-1.1f]},block_state:{Name:light_blue_stained_glass}}]}
execute if score @s magic_level matches 1 if score @s mana matches 200.. run tellraw @s[tag=!use_protego] {"text":"Protego!"}
execute if score @s magic_level matches 1 if score @s mana matches 200.. run tag @s[tag=!use_protego] add use_protego
execute if score @s magic_level matches 2 if score @s mana matches 800.. at @s[tag=!use_protego] run summon armor_stand ~ ~ ~ {Tags:[protego],Invisible:1b,NoGravity:1b,Silent:1b,Invulnerable:1b,Passengers:[{id:block_display,Tags:["protego_display"],transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],scale:[2.2f,2.2f,2.2f],translation:[-1.1f,-2f,-1.1f]},block_state:{Name:light_blue_stained_glass}}]}
execute if score @s magic_level matches 2 if score @s mana matches 800.. run tellraw @s[tag=!use_protego] {"text":"Protego!"}
execute if score @s magic_level matches 2 if score @s mana matches 800.. run tag @s[tag=!use_protego] add use_protego
execute if score @s magic_level matches 3 if score @s mana matches 1800.. at @s[tag=!use_protego] run summon armor_stand ~ ~ ~ {Tags:[protego],Invisible:1b,NoGravity:1b,Silent:1b,Invulnerable:1b,Passengers:[{id:block_display,Tags:["protego_display"],transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],scale:[2.2f,2.2f,2.2f],translation:[-1.1f,-2f,-1.1f]},block_state:{Name:light_blue_stained_glass}}]}
execute if score @s magic_level matches 3 if score @s mana matches 1800.. run tellraw @s[tag=!use_protego] {"text":"Protego!"}
execute if score @s magic_level matches 3 if score @s mana matches 1800.. run tag @s[tag=!use_protego] add use_protego
execute if score @s magic_level matches 4 if score @s mana matches 3200.. at @s[tag=!use_protego] run summon armor_stand ~ ~ ~ {Tags:[protego],Invisible:1b,NoGravity:1b,Silent:1b,Invulnerable:1b,Passengers:[{id:block_display,Tags:["protego_display"],transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],scale:[2.2f,2.2f,2.2f],translation:[-1.1f,-2f,-1.1f]},block_state:{Name:light_blue_stained_glass}}]}
execute if score @s magic_level matches 4 if score @s mana matches 3200.. run tellraw @s[tag=!use_protego] {"text":"Protego!"}
execute if score @s magic_level matches 4 if score @s mana matches 3200.. run tag @s[tag=!use_protego] add use_protego
execute if score @s magic_level matches 5 if score @s mana matches 5000.. at @s[tag=!use_protego] run summon armor_stand ~ ~ ~ {Tags:[protego],Invisible:1b,NoGravity:1b,Silent:1b,Invulnerable:1b,Passengers:[{id:block_display,Tags:["protego_display"],transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],scale:[2.2f,2.2f,2.2f],translation:[-1.1f,-2f,-1.1f]},block_state:{Name:light_blue_stained_glass}}]}
execute if score @s magic_level matches 5 if score @s mana matches 5000.. run tellraw @s[tag=!use_protego] {"text":"Protego!"}
execute if score @s magic_level matches 5 if score @s mana matches 5000.. run tag @s[tag=!use_protego] add use_protego
execute if score @s magic_level matches 6 if score @s mana matches 7200.. at @s[tag=!use_protego] run summon armor_stand ~ ~ ~ {Tags:[protego],Invisible:1b,NoGravity:1b,Silent:1b,Invulnerable:1b,Passengers:[{id:block_display,Tags:["protego_display"],transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],scale:[2.2f,2.2f,2.2f],translation:[-1.1f,-2f,-1.1f]},block_state:{Name:light_blue_stained_glass}}]}
execute if score @s magic_level matches 6 if score @s mana matches 7200.. run tellraw @s[tag=!use_protego] {"text":"Protego!"}
execute if score @s magic_level matches 6 if score @s mana matches 7200.. run tag @s[tag=!use_protego] add use_protego
execute if score @s magic_level matches 7 if score @s mana matches 9800.. at @s[tag=!use_protego] run summon armor_stand ~ ~ ~ {Tags:[protego],Invisible:1b,NoGravity:1b,Silent:1b,Invulnerable:1b,Passengers:[{id:block_display,Tags:["protego_display"],transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],scale:[2.2f,2.2f,2.2f],translation:[-1.1f,-2f,-1.1f]},block_state:{Name:light_blue_stained_glass}}]}
execute if score @s magic_level matches 7 if score @s mana matches 9800.. run tellraw @s[tag=!use_protego] {"text":"Protego!"}
execute if score @s magic_level matches 7 if score @s mana matches 9800.. run tag @s[tag=!use_protego] add use_protego
execute if score @s magic_level matches 8 if score @s mana matches 12800.. at @s[tag=!use_protego] run summon armor_stand ~ ~ ~ {Tags:[protego],Invisible:1b,NoGravity:1b,Silent:1b,Invulnerable:1b,Passengers:[{id:block_display,Tags:["protego_display"],transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],scale:[2.2f,2.2f,2.2f],translation:[-1.1f,-2f,-1.1f]},block_state:{Name:light_blue_stained_glass}}]}
execute if score @s magic_level matches 8 if score @s mana matches 12800.. run tellraw @s[tag=!use_protego] {"text":"Protego!"}
execute if score @s magic_level matches 8 if score @s mana matches 12800.. run tag @s[tag=!use_protego] add use_protego
execute if score @s magic_level matches 9 if score @s mana matches 16200.. at @s[tag=!use_protego] run summon armor_stand ~ ~ ~ {Tags:[protego],Invisible:1b,NoGravity:1b,Silent:1b,Invulnerable:1b,Passengers:[{id:block_display,Tags:["protego_display"],transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],scale:[2.2f,2.2f,2.2f],translation:[-1.1f,-2f,-1.1f]},block_state:{Name:light_blue_stained_glass}}]}
execute if score @s magic_level matches 9 if score @s mana matches 16200.. run tellraw @s[tag=!use_protego] {"text":"Protego!"}
execute if score @s magic_level matches 9 if score @s mana matches 16200.. run tag @s[tag=!use_protego] add use_protego
execute if score @s magic_level matches 10 if score @s mana matches 20000.. at @s[tag=!use_protego] run summon armor_stand ~ ~ ~ {Tags:[protego],Invisible:1b,NoGravity:1b,Silent:1b,Invulnerable:1b,Passengers:[{id:block_display,Tags:["protego_display"],transformation:{left_rotation:[0f,0f,0f,1f],right_rotation:[0f,0f,0f,1f],scale:[2.2f,2.2f,2.2f],translation:[-1.1f,-2f,-1.1f]},block_state:{Name:light_blue_stained_glass}}]}
execute if score @s magic_level matches 10 if score @s mana matches 20000.. run tellraw @s[tag=!use_protego] {"text":"Protego!"}
execute if score @s magic_level matches 10 if score @s mana matches 20000.. run tag @s[tag=!use_protego] add use_protego



##execute at @s positioned ~-1.1 ~ ~-1.1 run tp @e[sort=nearest,limit=1,tag=protego] ~ ~ ~
execute at @s[tag=use_protego] run tp @n[tag=protego] ~ ~ ~

effect give @s[tag=use_protego] resistance 1 3 true
attribute @s[tag=use_protego] generic.movement_speed base set 0.04
attribute @s[tag=use_protego] generic.jump_strength base set 0.2


scoreboard players remove @s[scores={magic_level=1},tag=use_protego] mana 10
scoreboard players remove @s[scores={magic_level=2},tag=use_protego] mana 40
scoreboard players remove @s[scores={magic_level=3},tag=use_protego] mana 90
scoreboard players remove @s[scores={magic_level=4},tag=use_protego] mana 160
scoreboard players remove @s[scores={magic_level=5},tag=use_protego] mana 250
scoreboard players remove @s[scores={magic_level=6},tag=use_protego] mana 360
scoreboard players remove @s[scores={magic_level=7},tag=use_protego] mana 490
scoreboard players remove @s[scores={magic_level=8},tag=use_protego] mana 640
scoreboard players remove @s[scores={magic_level=9},tag=use_protego] mana 810
scoreboard players remove @s[scores={magic_level=10},tag=use_protego] mana 1000


execute as @s[tag=use_protego] at @s positioned ~ ~1.1 ~ as @e[type=#impact_projectiles,distance=..3,tag=!beaten] at @s run playsound block.glass.break block @a ~ ~ ~ 0.75 0.75 0
execute as @s[tag=use_protego] at @s run kill @e[type=#impact_projectiles,distance=..2.5]
execute as @s[tag=use_protego] at @s positioned ~ ~1.1 ~ as @e[type=#impact_projectiles,distance=..3,tag=!beaten] store result entity @s Motion[0] double -0.7 run data get entity @s Motion[0]
##execute positioned ~ ~1.1 ~ as @e[type=#impact_projectiles,distance=..2.5] store result entity @s Motion[1] double -0.5 run data get entity @s Motion[1]
execute as @s[tag=use_protego] at @s positioned ~ ~1.1 ~ as @e[type=#impact_projectiles,distance=..3,tag=!beaten] store result entity @s Motion[2] double -0.7 run data get entity @s Motion[2]
execute as @s[tag=use_protego] at @s positioned ~ ~1.1 ~ as @e[type=#impact_projectiles,distance=..3,tag=!beaten] run tag @s add beaten



execute as @s[tag=use_protego] at @s positioned ~ ~1.1 ~ as @e[tag=!curse,tag=spell,distance=..4,tag=!beaten] at @s run playsound block.glass.break block @a ~ ~ ~ 0.75 0.75 0
##kill @e[tag=spell,distance=..2.5]
execute as @s[tag=use_protego] at @s positioned ~ ~1.1 ~ as @e[tag=!curse,tag=spell,distance=..4,tag=!beaten] store result score @s motion_x run data get entity @s Motion[0] -1000
##execute positioned ~ ~1.1 ~ as @e[type=#impact_projectiles,distance=..2.5] store result entity @s Motion[1] double -0.5 run data get entity @s Motion[1]
execute as @s[tag=use_protego] at @s positioned ~ ~1.1 ~ as @e[tag=!curse,tag=spell,distance=..4,tag=!beaten] store result score @s motion_z run data get entity @s Motion[2] -1000
execute as @s[tag=use_protego] at @s positioned ~ ~1.1 ~ as @e[tag=!curse,tag=spell,distance=..4,tag=!beaten] run tag @s add beaten



execute if score @s magic_level matches 1 unless score @s mana matches 1.. run tag @s remove use_protego
execute if score @s magic_level matches 2 unless score @s mana matches 1.. run tag @s remove use_protego
execute if score @s magic_level matches 3 unless score @s mana matches 1.. run tag @s remove use_protego
execute if score @s magic_level matches 4 unless score @s mana matches 1.. run tag @s remove use_protego
execute if score @s magic_level matches 5 unless score @s mana matches 1.. run tag @s remove use_protego
execute if score @s magic_level matches 6 unless score @s mana matches 1.. run tag @s remove use_protego
execute if score @s magic_level matches 7 unless score @s mana matches 1.. run tag @s remove use_protego
execute if score @s magic_level matches 8 unless score @s mana matches 1.. run tag @s remove use_protego
execute if score @s magic_level matches 9 unless score @s mana matches 1.. run tag @s remove use_protego
execute if score @s magic_level matches 10 unless score @s mana matches 1.. run tag @s remove use_protego
